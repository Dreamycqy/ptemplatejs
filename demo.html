<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
		<script src="ptemplate.js"></script>
		<script src="ptemplate.extend.tmplattrs.js"></script>
		<script src="ptemplate.extend.tmplfilter.js"></script>
		<script src="ptemplate.extend.jsonp.js"></script>
		<script src="ptemplate.extend.ajax.js"></script>
		<style>
			body {
				background: #f4f5f7;
				font-family: 微软雅黑;
			}
			body, ul, p {
				list-style: none;
				padding: 0;
				margin: 0;
			}
		</style>
	</head>
	<body>
		<div p-template="test">
			<h1 p-custom:title="{{title}}" p-custom:data-custom="{{title | custom : 123}}">{{title | lowercase}}</h1>
			<a p-router:href="/test" target="_blank" p-handle:click="handleClickFn" p-handle:watch="handleWatchFn">{{title | lowercase}}</a><br />
			<input type="text" value="{{title | uppercase}}" p-handle:change="handleChangeFn" />
			<span><b p-express:if="'{{title | lowercase}}' == 'test'" style="{{style}}">1</b><b p-express:if="'{{title | lowercase}}' != 'test'">2</b></span>
			<ul>
				<li p-express:for="i in data" p-express:if="index % {{index}}">
					<a p-custom:href="{{url}}" target="_blank" p-handle:click="handleForClick">{{newstitle}}</a>
				</li>
			</ul>
		</div>
		<div id="main"></div>
		<div id="mainA"></div>
		<script>
			(function(win, $){
				$.ready(function(){
					$.extend($.__mod__.tmplThesaurus, {
						custom: function(val, filterCondition){
							console.log(val, filterCondition)
							return val;
						}
					});
					$.setBaseFontSize(16);
					var baseFontSize = window.baseFontSize || $.getBaseFontSize(),
						styles = $.createStyle({
							alink: {
								fontWeight:400,
								fontSize:(30/baseFontSize).toFixed(4)+"rem",
								color:"rgb(255,255,255)",
								width:(40/baseFontSize).toFixed(4)+"rem",
								height:(40/baseFontSize).toFixed(4)+"rem",
								textAlign:"center",
								borderRadius:(30/baseFontSize).toFixed(4)+"rem",
								display:"inline-block",
								backgroundColor:"rgb(100,149,237)"
							},
							alinkbutton:{
								fontWeight:400,
								fontSize:(80/baseFontSize).toFixed(4)+"rem"
							}
						});
					$.router({
						"/test":{
							path: "/",
							params: {
								a:1
							}
						}
					}).render("test", {
						title: "test",
						index:2,
						style: styles.alink,
						data:[{
							newstitle: "1 news item title ...",
							url: "/ccc"
						},{
							newstitle: "2 news item title ...",
							url: "/ccc"
						},{
							newstitle: "3 news item title ...",
							url: "/ccc"
						},{
							newstitle: "4 news item title ...",
							url: "/ccc"
						},{
							newstitle: "5 news item title ...",
							url: "/ccc"
						}],
						handle: {
							handleForClick(e){
								e.preventDefault();
								console.log("forClick")
							},
							handleWatchFn(e){
								console.log(e.type)
							},
							handleClickFn(e) {
								e.preventDefault();
								console.log(e.type,1);
							},
							handleChangeFn(e){
								console.log(e.type);
								this._set("test", {
									title: this.value
								})
							}
						}
					}, function(elem) {
						console.log(elem)
					}).clone("test", "test1").render("test1", {
						title: "test1",
						index: 3,
						style: styles.alink,
						data: function(ajaxSuccess, ajaxError){
							ajaxSuccess({data:[{
								newstitle: "1 news item title ...",
								url: "/ccc"
							},{
								newstitle: "2 news item title ...",
								url: "/ccc"
							},{
								newstitle: "3 news item title ...",
								url: "/ccc"
							},{
								newstitle: "4 news item title ...",
								url: "/ccc"
							},{
								newstitle: "5 news item title ...",
								url: "/ccc"
							}]});
						},
						handle: {
							handleWatchFn(e){
								console.log(e.type)
							},
							handleClickFn(e) {
								e.preventDefault();
								console.log(e.type,2);
							},
							handleChangeFn(e){
								console.log(e.type);
								this._set("test1", {
									title: this.value
								})
							}
						}
					}, $.query("#main"), function(elem) {
						console.log(elem)
					}).clone("test1", "test2").render("test2", {
						title: "test2",
						index: 0,
						style: styles.alink,
						handle: {
							handleWatchFn(e){
								console.log(e.type)
							},
							handleClickFn(e) {
								e.preventDefault();
								console.log(e.type,3);
								this.parentNode._append($.createDom("span", {
									title: "kkk",
									css: {
										display: "block"
									}
								}, $.createDom("a", {
									href: "/bbb",
									text: "baba",
									style: $.getStyle("alinkbutton") || styles.alinkbutton,
									handle: {
										click: function(e){
											e.preventDefault();
											console.log(e)
										}
									}
								}, $.createDom("i", {
									class: "bi bf"
								}))))
							},
							handleChangeFn(e){
								console.log(e.type);
								this._set("test2", {
									title: this.value
								})
							}
						}
					}, $.query("#mainA"), function(elem) {
						console.log(elem)
					});
				});
			})(this, pTemplate);
		</script>
	</body>
</html>